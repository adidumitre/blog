<!DOCTYPE html>
<html lang="en-us">
<title>Juice Shop | Posts</title>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.101.0" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://adidumitre.github.io/blog/css/index.css">
<link rel="canonical" href="https://adidumitre.github.io/blog/posts/raport_juiceshop/">
<link rel="alternate" type="application/rss+xml" href="" title="Posts">

<header>
  
    <a href="https://adidumitre.github.io/blog/" class="title">Posts</a>
  
  
</header>

<article>
  <header>
    <h1>Juice Shop</h1>
    <time datetime="2022-09-19T21:08:26&#43;03:00">September 19, 2022</time>
  </header>
  <!-- raw HTML omitted -->
<h2 id="1-sql-injection">1. SQL Injection</h2>
<hr>
<h2 id="vulnerability-description">Vulnerability Description</h2>
<p>SQL injection is a technique that attackers use to gain unauthorized access to a web application database by adding a string of malicious code to a database query. A SQL injection (SQLi) manipulates SQL code to provide access to protected resources, such as sensitive data, or execute malicious SQL statements. <!-- raw HTML omitted --></p>
<p>SQL injection is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. It generally allows an attacker to view data that they are not normally able to retrieve. This might include data belonging to other users, or any other data that the application itself is able to access. In many cases, an attacker can modify or delete this data, causing persistent changes to the application&rsquo;s content or behavior. <!-- raw HTML omitted --></p>
<p>Without sufficient removal or quoting of SQL syntax in user-controllable inputs, the generated SQL query can cause those inputs to be interpreted as SQL instead of ordinary user data. This can be used to alter query logic to bypass security checks, or to insert additional statements that modify the back-end database, possibly including the execution of system commands. <!-- raw HTML omitted --></p>
<p>There are a wide variety of SQL injection vulnerabilities, attacks, and techniques, which arise in different situations. Some common SQL injection attacks include Classic SQLI, Blind or Inference SQL injection, Database management system-specific SQLI.</p>
<hr>
<h2 id="affected-component">Affected Component</h2>
<pre><code>http://localhost:3000/rest/user/login
</code></pre>
<hr>
<h2 id="affected-users">Affected Users</h2>
<pre><code>All the users that have an account
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce">Proof of Concept (Steps to Reproduce)</h2>
<p>Directly from the web application.<!-- raw HTML omitted --></p>
<ol>
<li>
<p>Log in with Email <code>' or 1=1--</code> and any <code>Password</code> which will authenticate the first entry in the Users table which coincidentally happens to be the administrator <!-- raw HTML omitted --></p>
</li>
<li>
<p>Log in with Email <a href="mailto:admin@juice-sh.op">admin@juice-sh.op</a>&rsquo;&ndash; and any Password if you already know the email address of the administrator <!-- raw HTML omitted --></p>
</li>
<li>
<p>You can also use a tool like Burp to intercept all the requests. <!-- raw HTML omitted --></p>
</li>
</ol>
<p><img src="https://user-images.githubusercontent.com/92368728/191295772-5b3d9a0f-6e64-40db-a380-4583a2a2e3e9.png" alt="img1">
<!-- raw HTML omitted --></p>
<p>We can observe in the Response that the application is vulnerable to SQL Injection. It also shows us how SQL query looks like.<!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191296086-093f65c4-b812-44c4-9865-cf801b32edbd.png" alt="img2"></p>
<hr>
<h2 id="criticality-this-is-a-critical-vulnerability">Criticality: This is a critical vulnerability.</h2>
<p><code>Impact:</code> An attacker can escalate the attack to compromise the underlying server or other back-end infrastructure or perform a denial-of-service attack. Many high-profile data breaches in recent years have been the result of SQL injection attacks, leading to reputational damage and regulatory fines. In some cases, an attacker can obtain a persistent backdoor into an organization&rsquo;s systems, leading to a long-term compromise that can go unnoticed for an extended period.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191296467-f852d9db-3b22-46ff-b754-8c36e08922d9.png" alt="img3"></p>
<hr>
<h2 id="suggested-fixes-remediations">Suggested Fixes (Remediations)</h2>
<p><code>Primary Defenses</code></p>
<p>Option 1: Use of Prepared Statements (with Parameterized Queries)<!-- raw HTML omitted -->
Option 2: Use of Properly Constructed Stored Procedures <!-- raw HTML omitted -->
Option 3: Allow-list Input Validation
Option 4: Escaping All User Supplied Input</p>
<hr>
<p><code> Additional Defenses:</code></p>
<p>Also: Enforcing Least Privilege<!-- raw HTML omitted -->
Also: Performing Allow-list Input Validation as a Secondary Defense</p>
<hr>
<h2 id="2-brute-force-login-page-is-vulnerable-to-password-guessing-attacks">2. Brute-Force: Login page is vulnerable to password-guessing attacks</h2>
<hr>
<h2 id="vulnerability-description-1">Vulnerability Description</h2>
<p>A brute force attack is a type of cyber attack that uses a trial-and-error method to guess all possible combinations of a password, encryption key, or any login information. It is called “brute force” because the malicious actor will use repetitive, forceful attempts to gain unauthorized access to an account. Though surprisingly simple, brute force attacks have a high success rate.</p>
<hr>
<h2 id="affected-component-1">Affected Component</h2>
<pre><code>http://localhost:3000/rest/user/login
</code></pre>
<hr>
<h2 id="affected-users-1">Affected Users</h2>
<p>All the users that have an account</p>
<hr>
<h2 id="proof-of-concept-steps-to-reproducebr">Proof of Concept (Steps to Reproduce)<!-- raw HTML omitted --></h2>
<p>Brute froce the password with burp on <a href="mailto:admin@juice-sh.op">admin@juice-sh.op</a>. <!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191488686-6dd0ea64-7978-4fec-af68-a8051ad6e639.png" alt="img4"></p>
<hr>
<h2 id="criticality-this-is-a-critical-vulnerability-1">Criticality: This is a critical vulnerability.</h2>
<p><code>Impact</code>: An attacker could perform an arbitrary number of authentication attempts using different passwords, and eventually, gain access to a user account.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-1">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191488761-03998162-2215-4da2-a9f1-2b5fa09b68fc.png" alt="img5"></p>
<hr>
<h2 id="suggested-fixes-remediations-1">Suggested Fixes (Remediations)</h2>
<ol>
<li>
<p>Use Strong Passwords.
Having a strong password policy is the simplest and most effective way of thwarting a brute-force attack. You would want to create a complex password for your web application or a public server that is impossible to guess but is relatively easy to remember.</p>
</li>
<li>
<p>Limit Login Attempts.<br>
By default, most websites, especially if they run on WordPress, allow unlimited login attempts. If you are a website administrator, you can use a plugin to limit the login attempts possible on your site to block brute force attacks. Such plugins allow you to enter the number of logins you want your visitors to have. Once they exceed the number of attempts, their IP addresses will be banned from your site for a considerable length of time.</p>
</li>
<li>
<p>Monitor IP addresses.<br>
In relation to the second tactic, you should limit login attempts to users coming from a specified IP address or range. This is especially important if you have a hybrid work environment or most of your employees work remotely. Set up alerts whenever you encounter login attempts from anomalous IP addresses and make sure to block them.</p>
</li>
<li>
<p>Use Two-Factor Authentication (2FA).<br>
Two-factor or multi-factor authentication adds an extra layer of security to your accounts. 2FA requires a user to validate their identity when logging into an account before being granted access. For example, you would be asked to confirm that it was indeed you who’s trying to log into your email when you have 2FA enabled. Before gaining access to your account, you would have to key in a unique code sent to your mobile number as a way of verifying your identity.</p>
</li>
<li>
<p>Use CAPTCHAs.<br>
CAPTCHA stands for “Completely Automated Public Turing test to tell Computers and Humans Apart.” Essentially, CAPTCHAs are challenges that are difficult for automated computer programs to perform but are easy for humans, such as spotting patterns or clicking in a specific area on a webpage. Websites use them to restrict usage by bots and spam.</p>
</li>
<li>
<p>Use Unique Login URLs
Creating unique login URLs for various user groups would be another challenging and time-consuming step for an attacker. It may not necessarily stop a brute force attack; however, it could deter attackers who can’t be bothered.</p>
</li>
<li>
<p>Disable Root SSH Logins
Brute force attempts made on the Secure Shell (SSH) protocol are made possible via the root user. Edit the sshd_config file and set it to “DenyUsers root” and “PermitRootLogin no” options to ensure that the root user cannot be accessed via SSH.</p>
</li>
<li>
<p>Use Web Application Firewalls (WAFs)
A web application firewall (WAF) offers adequate protection against brute force attacks that attempt unauthorized access to your system. It usually enforces a maximum number of requests to a URL space from a source during a specific time interval. Apart from brute force attacks that aim to gain access to steal session tokens, WAFs can prevent denial-of-service (DOS) attacks that drain server resources and block vulnerability scanning tools that probe your computer network for weaknesses. <!-- raw HTML omitted --></p>
</li>
</ol>
<hr>
<h2 id="3-confidential-documents-exposed-to-public-access">3. Confidential documents exposed to public access</h2>
<hr>
<h2 id="vulnerability-description-2">Vulnerability Description</h2>
<p>Information disclosure, also known as information leakage, is when a website unintentionally reveals sensitive information to its users. Depending on the context, websites may leak all kinds of information to a potential attacker, including:</p>
<ol>
<li>Data about other users, such as usernames or financial information</li>
<li>Sensitive commercial or business data</li>
<li>Technical details about the website and its infrastructure</li>
</ol>
<p>The dangers of leaking sensitive user or business data are fairly obvious, but disclosing technical information can sometimes be just as serious. Although some of this information will be of limited use, it can potentially be a starting point for exposing an additional attack surface, which may contain other interesting vulnerabilities. The knowledge that you are able to gather could even provide the missing piece of the puzzle when trying to construct complex, high-severity attacks.</p>
<p>Occasionally, sensitive information might be carelessly leaked to users who are simply browsing the website in a normal fashion. More commonly, however, an attacker needs to elicit the information disclosure by interacting with the website in unexpected or malicious ways. They will then carefully study the website&rsquo;s responses to try and identify interesting behavior.</p>
<hr>
<h2 id="affected-component-2">Affected Component</h2>
<pre><code>http://localhost:3000/ftp
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-1">Proof of Concept (Steps to Reproduce)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191490811-22755035-a73b-4306-947f-06a441b8dd4e.png" alt="image">
<img src="https://user-images.githubusercontent.com/92368728/191490899-2fa364e2-9ee2-46ac-82dc-bfd3363e6f80.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-high-vulnerability">Criticality: This is a high vulnerability.</h2>
<p><code>Impact</code>: Backup and unreferenced files accidentally left accessible may leak sensitive information. Depending on the file, sensitive data can include configuration parameters or source code that help malicious users better understand how your website works, thus making it easier to craft an attack against your website. In some cases, passwords that may give attackers control over the entire WordPress installation can also be leaked.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-2">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191491075-820cb76b-008a-4802-961e-99f329111196.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-2">Suggested Fixes (Remediations)</h2>
<p>Remove the files if they are not required on your website. As an additional step, it is recommended to implement a security policy within your organization to disallow the creation of backup files in directories accessible from the web.</p>
<hr>
<h2 id="4-reflected-cross-site-scripting-xss">4. Reflected Cross-site Scripting (XSS)</h2>
<hr>
<h2 id="vulnerability-description-3">Vulnerability Description</h2>
<p>Cross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted websites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser-side script, to a different end user. Flaws that allow these attacks to succeed are quite widespread and occur anywhere a web application uses input from a user within the output it generates without validating or encoding it.</p>
<p>An attacker can use XSS to send a malicious script to an unsuspecting user. The end user’s browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site. These scripts can even rewrite the content of the HTML page.</p>
<hr>
<h2 id="affected-component-3">Affected Component</h2>
<pre><code>http://localhost:3000/rest/track-order
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-2">Proof of Concept (Steps to Reproduce)</h2>
<p>We need to track an order and capture the request to BurpSuite.
<img src="https://user-images.githubusercontent.com/92368728/191491742-228f9a2d-04d7-4028-b1d7-ce05617dbb4c.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-medium-vulnerability">Criticality: This is a medium vulnerability.</h2>
<p><code>Impact</code>: If an attacker can control a script that is executed in the victim&rsquo;s browser, then they can typically fully compromise that user. Amongst other things, the attacker can:<!-- raw HTML omitted --></p>
<ol>
<li>Perform any action within the application that the user can perform.</li>
<li>View any information that the user is able to view.</li>
<li>Modify any information that the user is able to modify.</li>
<li>Initiate interactions with other application users, including malicious attacks, that will appear to originate from the initial victim user.</li>
</ol>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-3">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<h2 id="imagehttpsuser-imagesgithubusercontentcom92368728191492362-a71cf492-dbe2-46e2-bf6c-56c331b4a861png"><img src="https://user-images.githubusercontent.com/92368728/191492362-a71cf492-dbe2-46e2-bf6c-56c331b4a861.png" alt="image"></h2>
<h2 id="suggested-fixes-remediations-3">Suggested Fixes (Remediations)</h2>
<p><code>Step 1</code>: Train and maintain awareness
To keep your web application safe, everyone involved in building the web application must be aware of the risks associated with XSS vulnerabilities. You should provide suitable security training to all your developers, QA staff, DevOps, and SysAdmins. You can start by referring them to this page.</p>
<p><code>Step 2</code>: Don’t trust any user input
Treat all user input as untrusted. Any user input that is used as part of HTML output introduces a risk of an XSS. Treat input from authenticated and/or internal users the same way that you treat public input.</p>
<p><code>Step 3</code>: Use escaping/encoding
Use an appropriate escaping/encoding technique depending on where user input is to be used: HTML escape, JavaScript escape, CSS escape, URL escape, etc. Use existing libraries for escaping, don’t write your own unless absolutely necessary.</p>
<p><code>Step 4</code>: Sanitize HTML
If the user input needs to contain HTML, you can’t escape/encode it because it would break valid tags. In such cases, use a trusted and verified library to parse and clean HTML. Choose the library depending on your development language, for example, HtmlSanitizer for .NET or SanitizeHelper for Ruby on Rails.</p>
<p><code>Step 5</code>: Set the HttpOnly flag
To mitigate the consequences of a possible XSS vulnerability, set the HttpOnly flag for cookies. If you do, such cookies will not be accessible via client-side JavaScript.</p>
<p><code>Step 6</code>: Use a Content Security Policy
To mitigate the consequences of a possible XSS vulnerability, also use a Content Security Policy (CSP). CSP is an HTTP response header that lets you declare the dynamic resources that are allowed to load depending on the request source.</p>
<p><code>Step 7</code>: Scan regularly (with Acunetix)
XSS vulnerabilities may be introduced by your developers or through external libraries/modules/software. You should regularly scan your web applications using a web vulnerability scanner such as Acunetix. If you use Jenkins, you should install the Acunetix plugin to automatically scan every build.</p>
<hr>
<h2 id="5database-exfiltration">5.Database exfiltration</h2>
<hr>
<h2 id="vulnerability-description-4">Vulnerability Description</h2>
<p>It is the process of removing, stealing, exporting, manipulating, and accessing private data in an unauthorized manner. It includes data saved or stored anywhere, mobile devices, servers, computers, external storage devices and more.</p>
<hr>
<h2 id="affected-component-4">Affected Component</h2>
<pre><code>http://localhost:3000/rest/products/search?q=
</code></pre>
<hr>
<h2 id="affected-users-2">Affected Users</h2>
<pre><code>All the users that have an account
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-3">Proof of Concept (Steps to Reproduce)</h2>
<ol>
<li>Sent the request to burp.</li>
<li>Use a syntax query to see all informations about the users from database. <!-- raw HTML omitted --></li>
</ol>
<p><img src="https://user-images.githubusercontent.com/92368728/191494191-208db3c3-5cfa-4183-9226-a5c68fb13d21.png" alt="image"><!-- raw HTML omitted --></p>
<p>Brutforce the security question.<!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191494392-97ae159d-207f-4c01-a425-2f6016edc8bf.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-critical-vulnerability-2">Criticality: This is a critical vulnerability.</h2>
<p><code>Impact</code>: A data exfiltration attack involves the unauthorized transfer of sensitive data, such as personal data and intellectual property, out of a target system and into a separate location.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-4">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191494604-de36ff74-df27-47e0-9b95-8137dafc52dc.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-4">Suggested Fixes (Remediations)</h2>
<p>Preventing data from being exfiltrated is reliant on deploying a security solution that includes features such as:</p>
<ol>
<li>Blocking unauthorized communication channels: Some strands of malware use external communication channels to exfiltrate data. Organizations therefore must block any unauthorized communication channels, such as direct and potentially compromised applications.</li>
<li>Credential theft and phishing prevention: The prevalence of phishing attacks means companies must be able to prevent users from entering their login credentials into spoofed websites. Prevention tools can also block keystroke logging, which enables an attacker to monitor and log a user’s keyboard activity.</li>
<li>Maintaining user experience: Preventing data exfiltration must not negatively impact user activity. Therefore, organizations should use tools that can detect legitimate application and communication activity, even on new applications.
User education: Educating users on the risks and threats they face is also important in detecting data exfiltration. Organizations need to ensure that employees understand the telltale signs of a cyberattack, not open malicious attachments, and not click on links included in emails</li>
</ol>
<hr>
<h2 id="6-broken-access-control-authorization-bypass-through-direct-http-request">6. Broken Access control: Authorization Bypass Through Direct HTTP Request</h2>
<hr>
<h2 id="vulnerability-description-5">Vulnerability Description</h2>
<p>The web application does not adequately enforce appropriate authorization on all restricted URLs. A normal user can access the functionality of other users. This is possible by the direct request of the application endpoint of the other users.</p>
<p>The system&rsquo;s authorization functionality does not prevent one user from gaining access to another user&rsquo;s functionality or records by accessing the endpoint directly. Web applications susceptible to direct request attacks often make the false assumption that such resources can only be reached through a given navigation path and so only apply authorization at certain points in the path.</p>
<p>Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification, or destruction of all data or performing a business function outside the user&rsquo;s limits.
Information disclosure, also known as information leakage, is when a website unintentionally reveals sensitive information to its users. Depending on the context, websites may leak all kinds of information to a potential attacker, including:</p>
<p>Data about other users, such as usernames or financial information
Sensitive commercial or business data
Technical details about the website and its infrastructure
The dangers of leaking sensitive user or business data are fairly obvious, but disclosing technical information can sometimes be just as serious. Although some of this information will be of limited use, it can potentially be a starting point for exposing an additional attack surface, which may contain other interesting vulnerabilities. The knowledge that you are able to gather could even provide the missing piece of the puzzle when trying to construct complex, high-severity attacks.</p>
<p>Occasionally, sensitive information might be carelessly leaked to users who are simply browsing the website in a normal fashion. More commonly, however, an attacker needs to elicit the information disclosure by interacting with the website in unexpected or malicious ways. They will then carefully study the website&rsquo;s responses to try and identify interesting behavior.</p>
<hr>
<h2 id="affected-component-5">Affected Component</h2>
<pre><code>http://localhost:3000/api/BasketItems
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-4">Proof of Concept (Steps to Reproduce)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191529357-59dbbfb2-a6be-4c69-8028-9d1297a09f09.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-high-vulnerability-1">Criticality: This is a high vulnerability.</h2>
<p><code>Impact</code>:Access control checks for specific user data or functionality can be bypassed. Horizontal escalation of privilege is possible (one user can view/modify information of another user).</p>
<p>Vertical escalation of privilege is possible if the user-controlled key is actually a flag that indicates administrator status, allowing the attacker to gain administrative access.</p>
<p>Access control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification or destruction of all data, or performing a business function outside of the limits of the user.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-5">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191529640-1a1e9a90-9621-46e1-8574-39939d4c9bb0.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-5">Suggested Fixes (Remediations)</h2>
<p>Preventing information disclosure completely is tricky due to the huge variety of ways in which it can occur. However, there are some general best practices that you can follow to minimize the risk of these kinds of vulnerability creeping into your own websites.</p>
<ol>
<li>Make sure that everyone involved in producing the website is fully aware of what information is considered sensitive. Sometimes seemingly harmless information can be much more useful to an attacker than people realize. Highlighting these dangers can help make sure that sensitive information is handled more securely in general by your organization.</li>
<li>Audit any code for potential information disclosure as part of your QA or build processes. It should be relatively easy to automate some of the associated tasks, such as stripping developer comments.
Use generic error messages as much as possible. Don&rsquo;t provide attackers with clues about application behavior unnecessarily.</li>
<li>Double-check that any debugging or diagnostic features are disabled in the production environment.</li>
<li>Make sure you fully understand the configuration settings, and security implications, of any third-party technology that you implement. <!-- raw HTML omitted --></li>
<li>Take the time to investigate and disable any features and settings that you don&rsquo;t actually need.</li>
</ol>
<hr>
<h2 id="7-malicious-file-upload-unrestricted-upload-of-file-with-dangerous-type">7. Malicious File Upload: Unrestricted upload of File with dangerous type</h2>
<hr>
<h2 id="vulnerability-description-6">Vulnerability Description</h2>
<p>Uploaded files represent a significant risk to applications. The first step in many attacks is to get some code to the system to be attacked. Then the attack only needs to find a way to get the code executed. Using a file upload helps the attacker accomplish the first step.</p>
<p>The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, client-side attacks, or simple defacement. It depends on what the application does with the uploaded file and especially where it is stored.</p>
<p>There are really two classes of problems here. The first is with the file metadata, like the path and file name. These are generally provided by the transport, such as HTTP multi-part encoding. This data may trick the application into overwriting a critical file or storing the file in a bad location. You must validate the metadata extremely carefully before using it.</p>
<p>The other class of problem is with the file size or content. The range of problems here depends entirely on what the file is used for. See the examples below for some ideas about how files might be misused. To protect against this type of attack, you should analyse everything your application does with files and think carefully about what processing and interpreters are involved.</p>
<hr>
<h2 id="affected-component-6">Affected Component</h2>
<pre><code>http://localhost:3000/file/upload
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-br">Proof of Concept (Steps to Reproduce) <!-- raw HTML omitted --></h2>
<p>Sent a normal PDF first. <!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>Copy the content from the Image <!-- raw HTML omitted --></p>
<p>Change the filename from Content-Disposition <!-- raw HTML omitted --></p>
<p>Change the Content-Type <!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191530855-c0ddc88a-53e8-4e52-85eb-75b5b04e9a46.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-high-vulnerability-2">Criticality: This is a high vulnerability.</h2>
<p><code>Impact</code>: The consequences of unrestricted file upload can vary, including complete system takeover, an overloaded file system or database, forwarding attacks to back-end systems, and simple defacement. It depends on what the application does with the uploaded file and especially where it is stored.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-6">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191531070-5a8ffec8-fd85-4613-86a6-c35c1d06bcf3.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-6">Suggested Fixes (Remediations)</h2>
<p>Developers must review upload functionality to determine if uploaded content is ever returned to other application users and whether that is due to normal application usage or attack manipulation. As a part of this revision, developers should consider:</p>
<p>If the application filters file extensions and the MIME type of the uploaded file.
If placing executable JavaScript or HTML into the file is possible.
If the header information is returned after the contents of a file are downloaded.
If the storage location for uploaded content is escapable with a crafted filename.</p>
<p>There are numerous steps toward a more robust upload code architecture that developers must consider in their design:</p>
<p>Developers must use an allow list, enforcing acceptance of only listed, non-executable file extensions.
Developers should ensure file names do not contain directory traversal characters such as ../ that are used to place files outside of designated directory locations.
Developers should alter permissions on the upload folder to ensure the files can’t be executed.
Uploads must not be placed in directories that are accessible from the web.
Developers should ensure that if uploaded files are downloaded by users, they contain X-Content-Type-options: nosniff header and a Content-Disposition header that commands browsers to handle files as an attachment.
Uploaded files should be subject to immediate virus scanning.
Developers must enforce size limits on uploaded files and reject archive formats (like ZIP) from being uploaded at all.</p>
<hr>
<h2 id="8-poison-null-byte">8. Poison Null Byte</h2>
<hr>
<h2 id="vulnerability-description-7">Vulnerability Description</h2>
<p>A null byte in many languages is used to detect the end of a string. As opposed to storing an integer value in the first byte or two of the string stating the total length. A null byte on the other hand would just be placed at the end of the string. By embedding NULL Bytes/characters into applications that do not handle postfix NULL terminators properly, an attacker can exploit a system using techniques such as directory traversal.</p>
<p>The Poison Null Byte exploit takes advantage strings with a known length that can contain null bytes, and whether or not the API being attacked uses null terminated strings. By placing a NULL byte in the string at a certain byte, the string will terminate at that point, nulling the rest of the string, such as a file extension.</p>
<hr>
<h2 id="affected-component-7">Affected Component</h2>
<pre><code>http://localhost:3000/ftp/eastere.gg
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-br-1">Proof of Concept (Steps to Reproduce) <!-- raw HTML omitted --></h2>
<p>We need to try to download the file.
<!-- raw HTML omitted -->
<img src="https://user-images.githubusercontent.com/92368728/191531586-8fba240e-6207-4a59-82bd-7b5aaacd287c.png" alt="image">
We can try to trick the website using Poison Null Byte
<img src="https://user-images.githubusercontent.com/92368728/191532823-ab649f55-d478-41ce-ab64-e4021016d16f.png" alt="image"></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191532876-8f2b5647-bb44-407a-adf9-799b9b85e8df.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-high-vulnerability-3">Criticality: This is a high vulnerability.</h2>
<p><code>Impact</code>: Backup and unreferenced files accidentally left accessible may leak sensitive information. Depending on the file, sensitive data can include configuration parameters or source code that help malicious users better understand how your website works, thus making it easier to craft an attack against your website. In some cases, passwords that may give attackers control over the entire WordPress installation can also be leaked.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-7">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191529640-1a1e9a90-9621-46e1-8574-39939d4c9bb0.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-7">Suggested Fixes (Remediations)</h2>
<p>There are a number of ways to prevent Poison Null Byte injections within PHP. These include escaping the NULL byte with a backslash, however, the most recommended way to do so is to completely remove the byte by using code similar to the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$file <span style="color:#f92672">=</span> str_replace<span style="color:#f92672">(</span>chr<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>, <span style="color:#e6db74">&#39;&#39;</span>, $string<span style="color:#f92672">)</span>;
</span></span></code></pre></div><hr>
<h2 id="9-two-factor-authentication-bypass">9. Two factor authentication bypass</h2>
<hr>
<h2 id="vulnerability-description-8">Vulnerability Description</h2>
<p>At times, the implementation of two-factor authentication is flawed to the point where it can be bypassed entirely.</p>
<p>If the user is first prompted to enter a password, and then prompted to enter a verification code on a separate page, the user is effectively in a &ldquo;logged in&rdquo; state before they have entered the verification code. In this case, it is worth testing to see if you can directly skip to &ldquo;logged-in only&rdquo; pages after completing the first authentication step. Occasionally, you will find that a website doesn&rsquo;t actually check whether or not you completed the second step before loading the page.</p>
<hr>
<h2 id="affected-component-8">Affected Component</h2>
<pre><code>http://localhost:3000/rest/user/login
</code></pre>
<hr>
<h2 id="affected-users-3">Affected Users</h2>
<pre><code>All the users that have an account
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-5">Proof of Concept (Steps to Reproduce)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191533333-06fff092-e99f-47aa-b5dc-fbfe3c6b29f4.png" alt="image"><!-- raw HTML omitted --></p>
<p>Extract the secret from the database.<!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191533483-4acede93-7518-4db7-b46c-3990e46f4a0f.png" alt="image"></p>
<p>Decode the old qr code.<!-- raw HTML omitted --></p>
<p><img src="https://user-images.githubusercontent.com/92368728/191533634-976792df-994b-4325-9bca-f8edb038efa4.png" alt="image"></p>
<hr>
<h2 id="criticality-this-is-a-critical-vulnerability-3">Criticality: This is a critical vulnerability.</h2>
<p><code>Impact</code>: An attacker can gain access to the victim account or access to the unauthorized resources.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-8">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191533951-139a49b0-392f-4e74-bbc1-937e8218c826.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-8">Suggested Fixes (Remediations)</h2>
<ol>
<li>
<p>Server should always issue randomized tokens</p>
</li>
<li>
<p>Server should have validation check whether the user has provided OTP value in the fields</p>
</li>
<li>
<p>Server should not reveal any kind of OTP codes in the response</p>
</li>
</ol>
<hr>
<h2 id="10-nosql-injection">10. NoSQL Injection</h2>
<hr>
<h2 id="vulnerability-description-9">Vulnerability Description</h2>
<p>A NoSQL injection vulnerability is an error in a web application that uses a NoSQL database. This web application security issue lets a malicious party bypass authentication, extract data, modify data, or even gain complete control over the application. NoSQL injection attacks are the result of a lack of data sanitization.</p>
<p>NoSQL injections are just one of many injection attacks, similar to traditional SQL Injections. They are engineered to exploit modern databases that do not use SQL. The term NoSQL (not only SQL) is used to describe databases that use a less rigid structure and may refer to many different types of databases, including those that use models such as key-value, key-document, column-family, or graph.</p>
<p>While NoSQL database engines have a different structure and do not support SQL statements and SQL queries, they still let users perform queries. They do not support one standardized language and therefore the query language is dependent on the implementation: database (e.g. MongoDB, Redis, Google Cloud Datastore, etc.), language (e.g. Python, PHP, etc.), and framework (e.g. Node.js, Angular). However, NoSQL queries are most often based on JSON and they can include user input. If this input is not sanitized, they are vulnerable to injections.</p>
<hr>
<h2 id="affected-component-9">Affected Component</h2>
<pre><code>http://localhost:3000/rest/products/reviews
</code></pre>
<hr>
<h2 id="proof-of-concept-steps-to-reproduce-6">Proof of Concept (Steps to Reproduce)</h2>
<ol>
<li>You can interact with the backend API for products reviews via the dedicated endpoints <code>/rest/products/reviews</code> and <code>/rest/products/{id}/reviews</code></li>
<li>Get the reviews of the product with database ID 1: <code>http://localhost/rest/products/1/reviews</code></li>
<li>Inject sleep(integer ms) command by changing the URL into <code>http://localhost:3000/rest/products/sleep(2000)/reviews</code></li>
</ol>
<hr>
<h2 id="criticality-this-is-a-high-vulnerability-4">Criticality: This is a high vulnerability.</h2>
<p><code>Impact</code>: Money, time, clients and even reputation can be lost in the event of a DoS/DDoS attack. Depending on the severity of an attack, resources could be offline for 24 hours, multiple days or even a week.</p>
<hr>
<h2 id="cvss-score-cvss-common-vulnerability-scoring-system-9">CVSS Score: CVSS (Common Vulnerability Scoring System)</h2>
<p><img src="https://user-images.githubusercontent.com/92368728/191529640-1a1e9a90-9621-46e1-8574-39939d4c9bb0.png" alt="image"></p>
<hr>
<h2 id="suggested-fixes-remediations-9">Suggested Fixes (Remediations)</h2>
<p>To avoid NoSQL injections, you must always treat user input as untrusted. Here is what you can do to validate user input:</p>
<ol>
<li>Use a sanitization library. For example, mongo-sanitize or mongoose.</li>
<li>If you can’t find a library for your environment, cast user input to the expected type. For example, cast usernames and passwords to strings.</li>
<li>In the case of MongoDB, never use where, mapReduce, or group operators with user input because these operators allow the attacker to inject JavaScript and are therefore much more dangerous than others. For extra safety, set javascriptEnabled to false in mongod.conf, if possible.</li>
<li>Additionally, always use the least-privilege model: run your application with the lowest privileges possible so that even if it gets exploited, the attacker cannot access other resources.</li>
</ol>
<hr>

</article>



</html>
